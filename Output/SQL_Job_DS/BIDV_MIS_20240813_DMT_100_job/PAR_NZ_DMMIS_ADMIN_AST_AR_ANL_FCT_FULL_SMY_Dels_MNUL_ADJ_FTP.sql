delete from AST_AR_ANL_FCT_FULL_SMY 
WHERE tm_prd_dim_id in (select distinct TM_PRD_DIM_ID from TMP_AR_ANL_FCT_MNUL_DAILY);

insert into AST_AR_ANL_FCT_FULL_SMY
SELECT ACG_STC_GRP_DIM_ID
       , ACT_TM_TO_MAT_SEG_DIM_ID
       , AR_BAL_SEG_DIM_ID
       , AR_CRT_DEPT_DIM_ID
       , AR_FNC_ST_DIM_ID
       , AR_LCS_DIM_ID
       , AR_MGT_DEPT_DIM_ID
       , AR_OFCR_CREATOR_DIM_ID
       , AR_OFCR_EMPE_DIM_ID
       , AR_PPS_DIM_ID
       , AR_TP_DIM_ID
       , BAL_ACG_STC_ITM_DIM_ID
       , BAL_SHET_TP_DIM_ID
       , CCY_DIM_ID
       , CR_LMT_SEG_DIM_ID
       , CR_RSK_RTG_DIM_ID
       , CST_AST_BAL_SEG_DIM_ID
       , CST_CRT_DEPT_DIM_ID
       , CST_LBY_BAL_SEG_DIM_ID
       , CST_LIFE_CYC_ST_DIM_ID
       , CST_MGT_DEPT_DIM_ID
       , CST_MKT_SEG_DIM_ID
       , CST_OFCR_CREATOR_DIM_ID
       , CST_OFCR_EMPE_DIM_ID
       , CST_PERF_ST_DIM_ID
       , CST_SEG_DIM_ID
       , CST_SEG_SME_DIM_ID
       , CST_TP_DIM_ID
       , IDY_SML_ID_DIM_ID
       , INT_RATE_SEG_DIM_ID
       , LINE_OF_BSN_DIM_ID
       , MTH_ISSU_TP_DIM_ID
       , ORG_UNIT_DIM_ID
       , ORIG_TM_TO_MAT_SEG_DIM_ID
       , PD_DIM_ID
       , RMAN_TM_TO_MAT_SEG_DIM_ID
       , RTO_DBT_TP_DIM_ID
       , SCR_CVR_DIM_ID
       , SRC_STM_DIM_ID
       , TM_PRD_DIM_ID
	   , CST_BRTH_AGE_SEG_DIM_ID
	   , CST_AGE_SEG_DIM_ID
	   , CST_BRN_AST_BAL_SEG_DIM_ID
	   , CST_BRN_LBY_BAL_SEG_DIM_ID
	   , nvl(cst_hier.CST_HIER_DIM_ID, 0) CST_HIER_DIM_ID
	   , nvl(cst_fi.CST_FI_HIER_DIM_ID,0) CST_FI_HIER_DIM_ID
       , sum(ADJ_INT_AMT_LTD_FCY) ADJ_INT_AMT_LTD_FCY
       , sum(ADJ_INT_AMT_LTD_LCY) ADJ_INT_AMT_LTD_LCY
       , sum(ADJ_INT_AMT_MTD_FCY) ADJ_INT_AMT_MTD_FCY
       , sum(ADJ_INT_AMT_MTD_LCY) ADJ_INT_AMT_MTD_LCY
       , sum(ADJ_INT_AMT_QTD_FCY) ADJ_INT_AMT_QTD_FCY
       , sum(ADJ_INT_AMT_QTD_LCY) ADJ_INT_AMT_QTD_LCY
       , sum(ADJ_INT_AMT_TDY_FCY) ADJ_INT_AMT_TDY_FCY
       , sum(ADJ_INT_AMT_TDY_LCY) ADJ_INT_AMT_TDY_LCY
       , sum(ADJ_INT_AMT_YTD_FCY) ADJ_INT_AMT_YTD_FCY
       , sum(ADJ_INT_AMT_YTD_LCY) ADJ_INT_AMT_YTD_LCY
       , sum(AST_ACR_PNY_INT_AMT_PTD_FCY) AST_ACR_PNY_INT_AMT_PTD_FCY
       , sum(AST_ACR_PNY_INT_AMT_PTD_LCY) AST_ACR_PNY_INT_AMT_PTD_LCY
       , sum(AST_ACR_INT_LTD_FCY) AST_ACR_INT_LTD_FCY
       , sum(AST_ACR_INT_LTD_LCY) AST_ACR_INT_LTD_LCY
       , max(CNTS_OD_BSN_NBR_OF_DYS) CNTS_OD_BSN_NBR_OF_DYS
       , max(CNTS_OD_NBR_OF_DYS) CNTS_OD_NBR_OF_DYS
       , sum(AST_ACR_INT_MTD_FCY) AST_ACR_INT_MTD_FCY
       , sum(AST_ACR_INT_MTD_LCY) AST_ACR_INT_MTD_LCY
       , sum(AST_ACR_INT_PTD_FCY) AST_ACR_INT_PTD_FCY
       , sum(AST_ACR_INT_PTD_LCY) AST_ACR_INT_PTD_LCY
       , sum(AST_ACR_INT_QTD_FCY) AST_ACR_INT_QTD_FCY
       , sum(AST_ACR_INT_QTD_LCY) AST_ACR_INT_QTD_LCY
       , sum(AST_ACR_INT_TDY_FCY) AST_ACR_INT_TDY_FCY
       , sum(AST_ACR_INT_TDY_LCY) AST_ACR_INT_TDY_LCY
       , sum(AST_ACR_INT_YTD_FCY) AST_ACR_INT_YTD_FCY
       , sum(AST_ACR_INT_YTD_LCY) AST_ACR_INT_YTD_LCY
       , sum(AST_ACR_PNY_INT_AMT_MTD_FCY) AST_ACR_PNY_INT_AMT_MTD_FCY
       , sum(AST_ACR_PNY_INT_AMT_MTD_LCY) AST_ACR_PNY_INT_AMT_MTD_LCY
       , sum(AST_ACR_PNY_INT_AMT_QTD_FCY) AST_ACR_PNY_INT_AMT_QTD_FCY
       , sum(AST_ACR_PNY_INT_AMT_QTD_LCY) AST_ACR_PNY_INT_AMT_QTD_LCY
       , sum(AST_ACR_PNY_INT_AMT_TDY_FCY) AST_ACR_PNY_INT_AMT_TDY_FCY
       , sum(AST_ACR_PNY_INT_AMT_TDY_LCY) AST_ACR_PNY_INT_AMT_TDY_LCY
       , sum(AST_ACR_PNY_INT_AMT_YTD_FCY) AST_ACR_PNY_INT_AMT_YTD_FCY
       , sum(AST_ACR_PNY_INT_AMT_YTD_LCY) AST_ACR_PNY_INT_AMT_YTD_LCY
       , avg(AST_ACT_INT_RATE_TDY) AST_ACT_INT_RATE_TDY
       , sum(AST_INT_PYMT_AMT_MTD_FCY) AST_INT_PYMT_AMT_MTD_FCY
       , sum(AST_INT_PYMT_AMT_MTD_LCY) AST_INT_PYMT_AMT_MTD_LCY
       , sum(AST_INT_PYMT_AMT_QTD_FCY) AST_INT_PYMT_AMT_QTD_FCY
       , sum(AST_INT_PYMT_AMT_QTD_LCY) AST_INT_PYMT_AMT_QTD_LCY
       , sum(AST_INT_PYMT_AMT_TDY_FCY) AST_INT_PYMT_AMT_TDY_FCY
       , sum(AST_INT_PYMT_AMT_TDY_LCY) AST_INT_PYMT_AMT_TDY_LCY
       , sum(AST_INT_PYMT_AMT_YTD_FCY) AST_INT_PYMT_AMT_YTD_FCY
       , sum(AST_INT_PYMT_AMT_YTD_LCY) AST_INT_PYMT_AMT_YTD_LCY
       , sum(CLS_BAL_AMT_LMTH_FCY) CLS_BAL_AMT_LMTH_FCY
       , sum(CLS_BAL_AMT_LMTH_LCY) CLS_BAL_AMT_LMTH_LCY
       , sum(CLS_BAL_AMT_LQTR_FCY) CLS_BAL_AMT_LQTR_FCY
       , sum(CLS_BAL_AMT_LQTR_LCY) CLS_BAL_AMT_LQTR_LCY
       , sum(CLS_BAL_AMT_LYR_FCY) CLS_BAL_AMT_LYR_FCY
       , sum(CLS_BAL_AMT_LYR_LCY) CLS_BAL_AMT_LYR_LCY
       , sum(CLS_BAL_AMT_TDY_FCY) CLS_BAL_AMT_TDY_FCY
       , sum(CLS_BAL_AMT_TDY_LCY) CLS_BAL_AMT_TDY_LCY
       , sum(CLS_ON_BAL_AMT_LMTH_FCY) CLS_ON_BAL_AMT_LMTH_FCY
       , sum(CLS_ON_BAL_AMT_LMTH_LCY) CLS_ON_BAL_AMT_LMTH_LCY
       , sum(CLS_ON_BAL_AMT_LQTR_FCY) CLS_ON_BAL_AMT_LQTR_FCY
       , sum(CLS_ON_BAL_AMT_LQTR_LCY) CLS_ON_BAL_AMT_LQTR_LCY
       , sum(CLS_ON_BAL_AMT_LYR_FCY) CLS_ON_BAL_AMT_LYR_FCY
       , sum(CLS_ON_BAL_AMT_LYR_LCY) CLS_ON_BAL_AMT_LYR_LCY
       , sum(CLS_ON_BAL_AMT_TDY_FCY) CLS_ON_BAL_AMT_TDY_FCY
       , sum(CLS_ON_BAL_AMT_TDY_LCY) CLS_ON_BAL_AMT_TDY_LCY
       , sum(CLS_ON_BAL_AMT_PREV_FCY) CLS_ON_BAL_AMT_PREV_FCY
       , sum(CLS_ON_BAL_AMT_PREV_LCY) CLS_ON_BAL_AMT_PREV_LCY
       , sum(CLS_LC_BAL_AMT_TDY_FCY) CLS_LC_BAL_AMT_TDY_FCY
       , sum(CLS_LC_BAL_AMT_TDY_LCY) CLS_LC_BAL_AMT_TDY_LCY
       , sum(CLS_BG_BAL_AMT_TDY_FCY) CLS_BG_BAL_AMT_TDY_FCY
       , sum(CLS_BG_BAL_AMT_TDY_LCY) CLS_BG_BAL_AMT_TDY_LCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_FCY) CLS_BAL_AMT_TO_WRT_OFF_FCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_LCY) CLS_BAL_AMT_TO_WRT_OFF_LCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_MTD_FCY) CLS_BAL_AMT_TO_WRT_OFF_MTD_FCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_MTD_LCY) CLS_BAL_AMT_TO_WRT_OFF_MTD_LCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_QTD_FCY) CLS_BAL_AMT_TO_WRT_OFF_QTD_FCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_QTD_LCY) CLS_BAL_AMT_TO_WRT_OFF_QTD_LCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_YTD_FCY) CLS_BAL_AMT_TO_WRT_OFF_YTD_FCY
       , sum(CLS_BAL_AMT_TO_WRT_OFF_YTD_LCY) CLS_BAL_AMT_TO_WRT_OFF_YTD_LCY
       , sum(DSBR_AMT_LTD_FCY) DSBR_AMT_LTD_FCY
       , sum(DSBR_AMT_LTD_LCY) DSBR_AMT_LTD_LCY
       , sum(DSBR_AMT_MTD_FCY) DSBR_AMT_MTD_FCY
       , sum(DSBR_AMT_MTD_LCY) DSBR_AMT_MTD_LCY
       , sum(DSBR_AMT_QTD_FCY) DSBR_AMT_QTD_FCY
       , sum(DSBR_AMT_QTD_LCY) DSBR_AMT_QTD_LCY
       , sum(DSBR_AMT_TDY_FCY) DSBR_AMT_TDY_FCY
       , sum(DSBR_AMT_TDY_LCY) DSBR_AMT_TDY_LCY
       , sum(DSBR_AMT_YTD_FCY) DSBR_AMT_YTD_FCY
       , sum(DSBR_AMT_YTD_LCY) DSBR_AMT_YTD_LCY
       , sum(INT_BAL_OF_SOLD_LOAN_FCY) INT_BAL_OF_SOLD_LOAN_FCY
       , sum(INT_BAL_OF_SOLD_LOAN_LCY) INT_BAL_OF_SOLD_LOAN_LCY
       , sum(LAST_INT_PYMT_AMT_FCY) LAST_INT_PYMT_AMT_FCY
       , sum(LAST_INT_PYMT_AMT_LCY) LAST_INT_PYMT_AMT_LCY
       , sum(LAST_PNP_PYMT_AMT_FCY) LAST_PNP_PYMT_AMT_FCY
       , sum(LAST_PNP_PYMT_AMT_LCY) LAST_PNP_PYMT_AMT_LCY
       , sum(NXT_INT_PYMT_AMT_FCY) NXT_INT_PYMT_AMT_FCY
       , sum(NXT_INT_PYMT_AMT_LCY) NXT_INT_PYMT_AMT_LCY
       , sum(NXT_PNP_PYMT_AMT_FCY) NXT_PNP_PYMT_AMT_FCY
       , sum(NXT_PNP_PYMT_AMT_LCY) NXT_PNP_PYMT_AMT_LCY
       , sum(NBR_OF_FEE_TXN_LTD) NBR_OF_FEE_TXN_LTD
       , sum(NBR_OF_FEE_TXN_MTD) NBR_OF_FEE_TXN_MTD
       , sum(NBR_OF_FEE_TXN_QTD) NBR_OF_FEE_TXN_QTD
       , sum(NBR_OF_FEE_TXN_TDY) NBR_OF_FEE_TXN_TDY
       , sum(NBR_OF_FEE_TXN_YTD) NBR_OF_FEE_TXN_YTD
       , sum(NBR_OF_INT_PYMT_SHD_CHG) NBR_OF_INT_PYMT_SHD_CHG
       , max(NBR_MAT_DT_CHG) NBR_MAT_DT_CHG
       , max(NBR_PYMT_SCH_CHG) NBR_PYMT_SCH_CHG
       , max(NBR_OF_RENEWS) NBR_OF_RENEWS
       , max(NBR_TERM_CHG) NBR_TERM_CHG
       , sum(OFF_BAL_ACR_INT_PTD_FCY) OFF_BAL_ACR_INT_PTD_FCY
       , sum(OFF_BAL_ACR_INT_PTD_LCY) OFF_BAL_ACR_INT_PTD_LCY
       , sum(OFF_BAL_INT_PYMT_AMT_LTD_FCY) OFF_BAL_INT_PYMT_AMT_LTD_FCY
       , sum(OFF_BAL_INT_PYMT_AMT_LTD_LCY) OFF_BAL_INT_PYMT_AMT_LTD_LCY
       , sum(OFF_BAL_INT_PYMT_AMT_MTD_FCY) OFF_BAL_INT_PYMT_AMT_MTD_FCY
       , sum(OFF_BAL_INT_PYMT_AMT_MTD_LCY) OFF_BAL_INT_PYMT_AMT_MTD_LCY
       , sum(OFF_BAL_INT_PYMT_AMT_QTD_FCY) OFF_BAL_INT_PYMT_AMT_QTD_FCY
       , sum(OFF_BAL_INT_PYMT_AMT_QTD_LCY) OFF_BAL_INT_PYMT_AMT_QTD_LCY
       , sum(OFF_BAL_INT_PYMT_AMT_TDY_FCY) OFF_BAL_INT_PYMT_AMT_TDY_FCY
       , sum(OFF_BAL_INT_PYMT_AMT_TDY_LCY) OFF_BAL_INT_PYMT_AMT_TDY_LCY
       , sum(OFF_BAL_INT_PYMT_AMT_YTD_FCY) OFF_BAL_INT_PYMT_AMT_YTD_FCY
       , sum(OFF_BAL_INT_PYMT_AMT_YTD_LCY) OFF_BAL_INT_PYMT_AMT_YTD_LCY
       , sum(OFF_BAL_PNP_PYMT_AMT_LTD_FCY) OFF_BAL_PNP_PYMT_AMT_LTD_FCY
       , sum(OFF_BAL_PNP_PYMT_AMT_LTD_LCY) OFF_BAL_PNP_PYMT_AMT_LTD_LCY
       , sum(OFF_BAL_PNP_PYMT_AMT_MTD_FCY) OFF_BAL_PNP_PYMT_AMT_MTD_FCY
       , sum(OFF_BAL_PNP_PYMT_AMT_MTD_LCY) OFF_BAL_PNP_PYMT_AMT_MTD_LCY
       , sum(OFF_BAL_PNP_PYMT_AMT_QTD_FCY) OFF_BAL_PNP_PYMT_AMT_QTD_FCY
       , sum(OFF_BAL_PNP_PYMT_AMT_QTD_LCY) OFF_BAL_PNP_PYMT_AMT_QTD_LCY
       , sum(OFF_BAL_PNP_PYMT_AMT_TDY_FCY) OFF_BAL_PNP_PYMT_AMT_TDY_FCY
       , sum(OFF_BAL_PNP_PYMT_AMT_TDY_LCY) OFF_BAL_PNP_PYMT_AMT_TDY_LCY
       , sum(OFF_BAL_PNP_PYMT_AMT_YTD_FCY) OFF_BAL_PNP_PYMT_AMT_YTD_FCY
       , sum(OFF_BAL_PNP_PYMT_AMT_YTD_LCY) OFF_BAL_PNP_PYMT_AMT_YTD_LCY
       , max(PAST_DUE_INT_NBR_OF_DYS) PAST_DUE_INT_NBR_OF_DYS
       , max(PAST_DUE_PNP_NBR_OF_DYS) PAST_DUE_PNP_NBR_OF_DYS
       , sum(PNY_FEE_AMT_MTD_FCY) PNY_FEE_AMT_MTD_FCY
       , sum(PNY_FEE_AMT_MTD_LCY) PNY_FEE_AMT_MTD_LCY
       , sum(PNY_FEE_AMT_QTD_FCY) PNY_FEE_AMT_QTD_FCY
       , sum(PNY_FEE_AMT_QTD_LCY) PNY_FEE_AMT_QTD_LCY
       , sum(PNY_FEE_AMT_TDY_FCY) PNY_FEE_AMT_TDY_FCY
       , sum(PNY_FEE_AMT_TDY_LCY) PNY_FEE_AMT_TDY_LCY
       , sum(PNY_FEE_AMT_YTD_FCY) PNY_FEE_AMT_YTD_FCY
       , sum(PNY_FEE_AMT_YTD_LCY) PNY_FEE_AMT_YTD_LCY
       , sum(PNP_PYMT_AMT_LTD_FCY) PNP_PYMT_AMT_LTD_FCY
       , sum(PNP_PYMT_AMT_LTD_LCY) PNP_PYMT_AMT_LTD_LCY
       , sum(PNP_PYMT_AMT_MTD_FCY) PNP_PYMT_AMT_MTD_FCY
       , sum(PNP_PYMT_AMT_MTD_LCY) PNP_PYMT_AMT_MTD_LCY
       , sum(PNP_PYMT_AMT_QTD_FCY) PNP_PYMT_AMT_QTD_FCY
       , sum(PNP_PYMT_AMT_QTD_LCY) PNP_PYMT_AMT_QTD_LCY
       , sum(PNP_PYMT_AMT_TDY_FCY) PNP_PYMT_AMT_TDY_FCY
       , sum(PNP_PYMT_AMT_TDY_LCY) PNP_PYMT_AMT_TDY_LCY
       , sum(PNP_PYMT_AMT_YTD_FCY) PNP_PYMT_AMT_YTD_FCY
       , sum(PNP_PYMT_AMT_YTD_LCY) PNP_PYMT_AMT_YTD_LCY
       , sum(PNP_PYMT_AT_MAT_AMT_FCY) PNP_PYMT_AT_MAT_AMT_FCY
       , sum(PNP_PYMT_AT_MAT_AMT_LCY) PNP_PYMT_AT_MAT_AMT_LCY
       , sum(RSK_WGHT_OTSND_AMT_FCY) RSK_WGHT_OTSND_AMT_FCY
       , sum(RSK_WGHT_OTSND_AMT_LCY) RSK_WGHT_OTSND_AMT_LCY
       , sum(SHD_PNP_PYMT_AMT_FCY) SHD_PNP_PYMT_AMT_FCY
       , sum(SHD_PNP_PYMT_AMT_LCY) SHD_PNP_PYMT_AMT_LCY
       , sum(SCRD_CLS_BAL_AMT_TDY_FCY) SCRD_CLS_BAL_AMT_TDY_FCY
       , sum(SCRD_CLS_BAL_AMT_TDY_LCY) SCRD_CLS_BAL_AMT_TDY_LCY
       , sum(TOT_AVL_AMT_FCY) TOT_AVL_AMT_FCY
       , sum(TOT_AVL_AMT_LCY) TOT_AVL_AMT_LCY
       , sum(TOT_CLT_PVDD_AMT_FCY) TOT_CLT_PVDD_AMT_FCY
       , sum(TOT_CLT_PVDD_AMT_LCY) TOT_CLT_PVDD_AMT_LCY
       , sum(TOT_CNTS_OD_DB_AMT_FCY) TOT_CNTS_OD_DB_AMT_FCY
       , sum(TOT_CNTS_OD_DB_AMT_LCY) TOT_CNTS_OD_DB_AMT_LCY
       , sum(TOT_GNL_PRVN_AMT_FCY) TOT_GNL_PRVN_AMT_FCY
       , sum(TOT_GNL_PRVN_AMT_LCY) TOT_GNL_PRVN_AMT_LCY
       , sum(TOT_LMT_AMT_FCY) TOT_LMT_AMT_FCY
       , sum(TOT_LMT_AMT_LCY) TOT_LMT_AMT_LCY
       , sum(TOT_OD_DB_AMT_FCY) TOT_OD_DB_AMT_FCY
       , sum(TOT_OD_DB_AMT_LCY) TOT_OD_DB_AMT_LCY
       , sum(TOT_PAST_DUE_INT_AMT_FCY) TOT_PAST_DUE_INT_AMT_FCY
       , sum(TOT_PAST_DUE_INT_AMT_LCY) TOT_PAST_DUE_INT_AMT_LCY
       , sum(TOT_PAST_DUE_PNP_AMT_FCY) TOT_PAST_DUE_PNP_AMT_FCY
       , sum(TOT_PAST_DUE_PNP_AMT_LCY) TOT_PAST_DUE_PNP_AMT_LCY
       , sum(TOT_SPF_PRVN_AMT_FCY) TOT_SPF_PRVN_AMT_FCY
       , sum(TOT_SPF_PRVN_AMT_LCY) TOT_SPF_PRVN_AMT_LCY
       , sum(TOT_WRT_OFF_AMT_FCY) TOT_WRT_OFF_AMT_FCY
       , sum(TOT_WRT_OFF_AMT_LCY) TOT_WRT_OFF_AMT_LCY
       , sum(UNUSED_PRVN_REVERSED_AMT_FCY) UNUSED_PRVN_REVERSED_AMT_FCY
       , sum(UNUSED_PRVN_REVERSED_AMT_LCY) UNUSED_PRVN_REVERSED_AMT_LCY
       , sum(USED_PRVN_AMT_FCY) USED_PRVN_AMT_FCY
       , sum(USED_PRVN_AMT_LCY) USED_PRVN_AMT_LCY
       , sum(BILL_INT_AMT_FCY) BILL_INT_AMT_FCY
       , sum(BILL_INT_AMT_LCY) BILL_INT_AMT_LCY
       , sum(BILL_LATE_CHRG_AMT_FCY) BILL_LATE_CHRG_AMT_FCY
       , sum(BILL_LATE_CHRG_AMT_LCY) BILL_LATE_CHRG_AMT_LCY
       , sum(BILL_PNP_AMT_FCY) BILL_PNP_AMT_FCY
       , sum(BILL_PNP_AMT_LCY) BILL_PNP_AMT_LCY
       , sum(AGRT_AST_INT_RATE_HTD) AGRT_AST_INT_RATE_HTD
       , sum(AGRT_AST_INT_RATE_MTD) AGRT_AST_INT_RATE_MTD
       , sum(AGRT_AST_INT_RATE_QTD) AGRT_AST_INT_RATE_QTD
       , sum(AGRT_AST_INT_RATE_R12MTH) AGRT_AST_INT_RATE_R12MTH
       , sum(AGRT_AST_INT_RATE_R1MTH) AGRT_AST_INT_RATE_R1MTH
       , sum(AGRT_AST_INT_RATE_R3MTH) AGRT_AST_INT_RATE_R3MTH
       , sum(AGRT_AST_INT_RATE_R6MTH) AGRT_AST_INT_RATE_R6MTH
       , sum(AGRT_AST_INT_RATE_YTD) AGRT_AST_INT_RATE_YTD
       , sum(AGRT_NIM_BAL_AMT_HTD_LCY) AGRT_NIM_BAL_AMT_HTD_LCY
       , sum(AGRT_NIM_BAL_AMT_MTD_LCY) AGRT_NIM_BAL_AMT_MTD_LCY
       , sum(AGRT_NIM_BAL_AMT_QTD_LCY) AGRT_NIM_BAL_AMT_QTD_LCY
       , sum(AGRT_NIM_BAL_AMT_YTD_LCY) AGRT_NIM_BAL_AMT_YTD_LCY
       , sum(AGRT_NIM_BAL_AMT_ROLLING_12MTH_LCY) AGRT_NIM_BAL_AMT_ROLLING_12MTH_LCY
       , sum(AGRT_NIM_BAL_AMT_ROLLING_1MTH_LCY) AGRT_NIM_BAL_AMT_ROLLING_1MTH_LCY
       , sum(AGRT_NIM_BAL_AMT_ROLLING_3MTH_LCY) AGRT_NIM_BAL_AMT_ROLLING_3MTH_LCY
       , sum(AGRT_NIM_BAL_AMT_ROLLING_6MTH_LCY) AGRT_NIM_BAL_AMT_ROLLING_6MTH_LCY
       , sum(AGRT_BAL_AMT_HTD_LCY) AGRT_BAL_AMT_HTD_LCY
       , sum(AGRT_BAL_AMT_MTD_LCY) AGRT_BAL_AMT_MTD_LCY
       , sum(AGRT_BAL_AMT_QTD_LCY) AGRT_BAL_AMT_QTD_LCY
       , sum(AGRT_BAL_AMT_YTD_LCY) AGRT_BAL_AMT_YTD_LCY
       , sum(AGRT_BAL_AMT_HTD_FCY) AGRT_BAL_AMT_HTD_FCY
       , sum(AGRT_BAL_AMT_MTD_FCY) AGRT_BAL_AMT_MTD_FCY
       , sum(AGRT_BAL_AMT_QTD_FCY) AGRT_BAL_AMT_QTD_FCY
       , sum(AGRT_BAL_AMT_YTD_FCY) AGRT_BAL_AMT_YTD_FCY
       , sum(AGRT_BAL_AMT_ROLLING_12MTH_LCY) AGRT_BAL_AMT_ROLLING_12MTH_LCY
       , sum(AGRT_BAL_AMT_ROLLING_1MTH_LCY) AGRT_BAL_AMT_ROLLING_1MTH_LCY
       , sum(AGRT_BAL_AMT_ROLLING_3MTH_LCY) AGRT_BAL_AMT_ROLLING_3MTH_LCY
       , sum(AGRT_BAL_AMT_ROLLING_6MTH_LCY) AGRT_BAL_AMT_ROLLING_6MTH_LCY
       , sum(AGRT_BAL_AMT_ROLLING_12MTH_FCY) AGRT_BAL_AMT_ROLLING_12MTH_FCY
       , sum(AGRT_BAL_AMT_ROLLING_1MTH_FCY) AGRT_BAL_AMT_ROLLING_1MTH_FCY
       , sum(AGRT_BAL_AMT_ROLLING_3MTH_FCY) AGRT_BAL_AMT_ROLLING_3MTH_FCY
       , sum(AGRT_BAL_AMT_ROLLING_6MTH_FCY) AGRT_BAL_AMT_ROLLING_6MTH_FCY
       , sum(AST_INT_INCM_MTD_FCY) AST_INT_INCM_MTD_FCY
       , sum(AST_INT_INCM_MTD_LCY) AST_INT_INCM_MTD_LCY
       , sum(AST_INT_INCM_QTD_FCY) AST_INT_INCM_QTD_FCY
       , sum(AST_INT_INCM_QTD_LCY) AST_INT_INCM_QTD_LCY
       , sum(AST_INT_INCM_YTD_FCY) AST_INT_INCM_YTD_FCY
       , sum(AST_INT_INCM_YTD_LCY) AST_INT_INCM_YTD_LCY
       , sum(AST_INT_INCM_TDY_FCY) AST_INT_INCM_TDY_FCY
       , sum(AST_INT_INCM_TDY_LCY) AST_INT_INCM_TDY_LCY
       , sum(AST_NML_INT_INCM_MTD_FCY) AST_NML_INT_INCM_MTD_FCY
       , sum(AST_NML_INT_INCM_MTD_LCY) AST_NML_INT_INCM_MTD_LCY
       , sum(AST_NML_INT_INCM_QTD_FCY) AST_NML_INT_INCM_QTD_FCY
       , sum(AST_NML_INT_INCM_QTD_LCY) AST_NML_INT_INCM_QTD_LCY
       , sum(AST_NML_INT_INCM_TDY_FCY) AST_NML_INT_INCM_TDY_FCY
       , sum(AST_NML_INT_INCM_TDY_LCY) AST_NML_INT_INCM_TDY_LCY
       , sum(AST_NML_INT_INCM_YTD_FCY) AST_NML_INT_INCM_YTD_FCY
       , sum(AST_NML_INT_INCM_YTD_LCY) AST_NML_INT_INCM_YTD_LCY
       , sum(AST_NML_INT_INCM_R12MTH_FCY) AST_NML_INT_INCM_R12MTH_FCY
       , sum(AST_NML_INT_INCM_R12MTH_LCY) AST_NML_INT_INCM_R12MTH_LCY
       , sum(AST_NML_INT_INCM_R1MTH_FCY) AST_NML_INT_INCM_R1MTH_FCY
       , sum(AST_NML_INT_INCM_R1MTH_LCY) AST_NML_INT_INCM_R1MTH_LCY
       , sum(AST_NML_INT_INCM_R3MTH_FCY) AST_NML_INT_INCM_R3MTH_FCY
       , sum(AST_NML_INT_INCM_R3MTH_LCY) AST_NML_INT_INCM_R3MTH_LCY
       , sum(AST_NML_INT_INCM_R6MTH_FCY) AST_NML_INT_INCM_R6MTH_FCY
       , sum(AST_NML_INT_INCM_R6MTH_LCY) AST_NML_INT_INCM_R6MTH_LCY
       , max(NBR_OF_DYS_ROLLING_12MTH) NBR_OF_DYS_ROLLING_12MTH
       , max(NBR_OF_DYS_ROLLING_1MTH) NBR_OF_DYS_ROLLING_1MTH
       , max(NBR_OF_DYS_ROLLING_3MTH) NBR_OF_DYS_ROLLING_3MTH
       , max(NBR_OF_DYS_ROLLING_6MTH) NBR_OF_DYS_ROLLING_6MTH
       , max(NBR_OF_DYS_HTD) NBR_OF_DYS_HTD
       , max(NBR_OF_DYS_MTD) NBR_OF_DYS_MTD
       , max(NBR_OF_DYS_QTD) NBR_OF_DYS_QTD
       , max(NBR_OF_DYS_YTD) NBR_OF_DYS_YTD
       , sum(AST_INT_INCM_R12MTH_FCY) AST_INT_INCM_R12MTH_FCY
       , sum(AST_INT_INCM_R12MTH_LCY) AST_INT_INCM_R12MTH_LCY
       , sum(AST_INT_INCM_R1MTH_FCY) AST_INT_INCM_R1MTH_FCY
       , sum(AST_INT_INCM_R1MTH_LCY) AST_INT_INCM_R1MTH_LCY
       , sum(AST_INT_INCM_R3MTH_FCY) AST_INT_INCM_R3MTH_FCY
       , sum(AST_INT_INCM_R3MTH_LCY) AST_INT_INCM_R3MTH_LCY
       , sum(AST_INT_INCM_R6MTH_FCY) AST_INT_INCM_R6MTH_FCY
       , sum(AST_INT_INCM_R6MTH_LCY) AST_INT_INCM_R6MTH_LCY
       , sum(AST_SCDY_ACR_INT_PTD_FCY) AST_SCDY_ACR_INT_PTD_FCY
       , sum(AST_SCDY_ACR_INT_PTD_LCY) AST_SCDY_ACR_INT_PTD_LCY
       , sum(AGRT_NIM_BAL_AMT_TDY_LCY) AGRT_NIM_BAL_AMT_TDY_LCY
       , sum(ACR_INT_TO_OFF_BAL_PTD_FCY) ACR_INT_TO_OFF_BAL_PTD_FCY
       , sum(ACR_INT_TO_OFF_BAL_PTD_LCY) ACR_INT_TO_OFF_BAL_PTD_LCY
       , sum(TOT_HLD_AMT_FCY) TOT_HLD_AMT_FCY
       , sum(TOT_HLD_AMT_LCY) TOT_HLD_AMT_LCY
       , sum(NXT_SHD_PYMT_AMT_FCY) NXT_SHD_PYMT_AMT_FCY
       , sum(NXT_SHD_PYMT_AMT_LCY) NXT_SHD_PYMT_AMT_LCY
       , sum(CLS_BAL_FRST_DAY_OVERDAFT_BSN_FCY) CLS_BAL_FRST_DAY_OVERDAFT_BSN_FCY
       , sum(CLS_BAL_FRST_DAY_OVERDAFT_BSN_LCY) CLS_BAL_FRST_DAY_OVERDAFT_BSN_LCY
       , sum(TOT_CNTS_OD_DB_BSN_AMT_FCY) TOT_CNTS_OD_DB_BSN_AMT_FCY
       , sum(TOT_CNTS_OD_DB_BSN_AMT_LCY) TOT_CNTS_OD_DB_BSN_AMT_LCY
       , avg(AST_BSC_FTP_RATE_TDY) AST_BSC_FTP_RATE_TDY
       , avg(AST_ADL_FTP_RATE_TDY) AST_ADL_FTP_RATE_TDY
       , sum(AST_AUTO_ADJ_FTP_AMT_MTD_FCY) AST_AUTO_ADJ_FTP_AMT_MTD_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_MTD_LCY) AST_AUTO_ADJ_FTP_AMT_MTD_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_QTD_FCY) AST_AUTO_ADJ_FTP_AMT_QTD_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_QTD_LCY) AST_AUTO_ADJ_FTP_AMT_QTD_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_TDY_FCY) AST_AUTO_ADJ_FTP_AMT_TDY_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_TDY_LCY) AST_AUTO_ADJ_FTP_AMT_TDY_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_YTD_FCY) AST_AUTO_ADJ_FTP_AMT_YTD_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_YTD_LCY) AST_AUTO_ADJ_FTP_AMT_YTD_LCY
       , sum(AST_BSC_FTP_AMT_MTD_FCY) AST_BSC_FTP_AMT_MTD_FCY
       , sum(AST_BSC_FTP_AMT_MTD_LCY) AST_BSC_FTP_AMT_MTD_LCY
       , sum(AST_BSC_FTP_AMT_QTD_FCY) AST_BSC_FTP_AMT_QTD_FCY
       , sum(AST_BSC_FTP_AMT_QTD_LCY) AST_BSC_FTP_AMT_QTD_LCY
       , sum(AST_BSC_FTP_AMT_TDY_FCY) AST_BSC_FTP_AMT_TDY_FCY
       , sum(AST_BSC_FTP_AMT_TDY_LCY) AST_BSC_FTP_AMT_TDY_LCY
       , sum(AST_BSC_FTP_AMT_YTD_FCY) AST_BSC_FTP_AMT_YTD_FCY
       , sum(AST_BSC_FTP_AMT_YTD_LCY) AST_BSC_FTP_AMT_YTD_LCY
       , sum(AST_BSC_NET_INT_MRGN_TDY) AST_BSC_NET_INT_MRGN_TDY
       , sum(AST_NET_INT_MRGN_TDY) AST_NET_INT_MRGN_TDY
       , sum(AST_MNUL_ADJ_FTP_AMT_MTD_FCY) AST_MNUL_ADJ_FTP_AMT_MTD_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_MTD_LCY) AST_MNUL_ADJ_FTP_AMT_MTD_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_QTD_FCY) AST_MNUL_ADJ_FTP_AMT_QTD_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_QTD_LCY) AST_MNUL_ADJ_FTP_AMT_QTD_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_TDY_FCY) AST_MNUL_ADJ_FTP_AMT_TDY_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_TDY_LCY) AST_MNUL_ADJ_FTP_AMT_TDY_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_YTD_FCY) AST_MNUL_ADJ_FTP_AMT_YTD_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_YTD_LCY) AST_MNUL_ADJ_FTP_AMT_YTD_LCY
       , sum(AGRT_ADL_AST_FTP_RATE_ROLLING_12MTH) AGRT_ADL_AST_FTP_RATE_ROLLING_12MTH
       , sum(AGRT_ADL_AST_FTP_RATE_ROLLING_1MTH) AGRT_ADL_AST_FTP_RATE_ROLLING_1MTH
       , sum(AGRT_ADL_AST_FTP_RATE_ROLLING_3MTH) AGRT_ADL_AST_FTP_RATE_ROLLING_3MTH
       , sum(AGRT_ADL_AST_FTP_RATE_ROLLING_6MTH) AGRT_ADL_AST_FTP_RATE_ROLLING_6MTH
       , sum(AGRT_ACT_AST_NIM_YTD) AGRT_ACT_AST_NIM_YTD
       , sum(AGRT_ADL_AST_FTP_RATE_HTD) AGRT_ADL_AST_FTP_RATE_HTD
       , sum(AGRT_ADL_AST_FTP_RATE_MTD) AGRT_ADL_AST_FTP_RATE_MTD
       , sum(AGRT_ADL_AST_FTP_RATE_QTD) AGRT_ADL_AST_FTP_RATE_QTD
       , sum(AGRT_ADL_AST_FTP_RATE_YTD) AGRT_ADL_AST_FTP_RATE_YTD
       , sum(AGRT_AST_NIM_HTD) AGRT_AST_NIM_HTD
       , sum(AGRT_AST_NIM_MTD) AGRT_AST_NIM_MTD
       , sum(AGRT_AST_NIM_QTD) AGRT_AST_NIM_QTD
       , sum(AGRT_AST_NIM_YTD) AGRT_AST_NIM_YTD
       , sum(AGRT_AST_NIM_R12MTH) AGRT_AST_NIM_R12MTH
       , sum(AGRT_AST_NIM_R1MTH) AGRT_AST_NIM_R1MTH
       , sum(AGRT_AST_NIM_R3MTH) AGRT_AST_NIM_R3MTH
       , sum(AGRT_AST_NIM_R6MTH) AGRT_AST_NIM_R6MTH
       , sum(AGRT_BSC_AST_FTP_RATE_HTD) AGRT_BSC_AST_FTP_RATE_HTD
       , sum(AGRT_BSC_AST_FTP_RATE_MTD) AGRT_BSC_AST_FTP_RATE_MTD
       , sum(AGRT_BSC_AST_FTP_RATE_QTD) AGRT_BSC_AST_FTP_RATE_QTD
       , sum(AGRT_BSC_AST_FTP_RATE_YTD) AGRT_BSC_AST_FTP_RATE_YTD
       , sum(AGRT_BSC_AST_FTP_RATE_ROLLING_12MTH) AGRT_BSC_AST_FTP_RATE_ROLLING_12MTH
       , sum(AGRT_BSC_AST_FTP_RATE_ROLLING_1MTH) AGRT_BSC_AST_FTP_RATE_ROLLING_1MTH
       , sum(AGRT_BSC_AST_FTP_RATE_ROLLING_3MTH) AGRT_BSC_AST_FTP_RATE_ROLLING_3MTH
       , sum(AGRT_BSC_AST_FTP_RATE_ROLLING_6MTH) AGRT_BSC_AST_FTP_RATE_ROLLING_6MTH
       , sum(AGRT_BSC_AST_NIM_HTD) AGRT_BSC_AST_NIM_HTD
       , sum(AGRT_BSC_AST_NIM_MTD) AGRT_BSC_AST_NIM_MTD
       , sum(AGRT_BSC_AST_NIM_QTD) AGRT_BSC_AST_NIM_QTD
       , sum(AGRT_BSC_AST_NIM_YTD) AGRT_BSC_AST_NIM_YTD
       , sum(AGRT_BSC_AST_NIM_R12MTH) AGRT_BSC_AST_NIM_R12MTH
       , sum(AGRT_BSC_AST_NIM_R1MTH) AGRT_BSC_AST_NIM_R1MTH
       , sum(AGRT_BSC_AST_NIM_R3MTH) AGRT_BSC_AST_NIM_R3MTH
       , sum(AGRT_BSC_AST_NIM_R6MTH) AGRT_BSC_AST_NIM_R6MTH
       , sum(AGRT_MNUL_ADJ_AST_NIM_MTD) AGRT_MNUL_ADJ_AST_NIM_MTD
       , sum(AGRT_MNUL_ADJ_AST_NIM_QTD) AGRT_MNUL_ADJ_AST_NIM_QTD
       , sum(AGRT_MNUL_ADJ_AST_NIM_YTD) AGRT_MNUL_ADJ_AST_NIM_YTD
       , sum(LMT_AMT_FCY) LMT_AMT_FCY
       , sum(LMT_AMT_LCY) LMT_AMT_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R12MTH_FCY) AST_MNUL_ADJ_FTP_AMT_R12MTH_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R12MTH_LCY) AST_MNUL_ADJ_FTP_AMT_R12MTH_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R1MTH_FCY) AST_MNUL_ADJ_FTP_AMT_R1MTH_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R1MTH_LCY) AST_MNUL_ADJ_FTP_AMT_R1MTH_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R3MTH_FCY) AST_MNUL_ADJ_FTP_AMT_R3MTH_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R3MTH_LCY) AST_MNUL_ADJ_FTP_AMT_R3MTH_LCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R6MTH_FCY) AST_MNUL_ADJ_FTP_AMT_R6MTH_FCY
       , sum(AST_MNUL_ADJ_FTP_AMT_R6MTH_LCY) AST_MNUL_ADJ_FTP_AMT_R6MTH_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R12MTH_FCY) AST_AUTO_ADJ_FTP_AMT_R12MTH_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R12MTH_LCY) AST_AUTO_ADJ_FTP_AMT_R12MTH_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R1MTH_FCY) AST_AUTO_ADJ_FTP_AMT_R1MTH_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R1MTH_LCY) AST_AUTO_ADJ_FTP_AMT_R1MTH_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R3MTH_FCY) AST_AUTO_ADJ_FTP_AMT_R3MTH_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R3MTH_LCY) AST_AUTO_ADJ_FTP_AMT_R3MTH_LCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R6MTH_FCY) AST_AUTO_ADJ_FTP_AMT_R6MTH_FCY
       , sum(AST_AUTO_ADJ_FTP_AMT_R6MTH_LCY) AST_AUTO_ADJ_FTP_AMT_R6MTH_LCY
       , sum(AST_BSC_FTP_AMT_R12MTH_FCY) AST_BSC_FTP_AMT_R12MTH_FCY
       , sum(AST_BSC_FTP_AMT_R12MTH_LCY) AST_BSC_FTP_AMT_R12MTH_LCY
       , sum(AST_BSC_FTP_AMT_R1MTH_FCY) AST_BSC_FTP_AMT_R1MTH_FCY
       , sum(AST_BSC_FTP_AMT_R1MTH_LCY) AST_BSC_FTP_AMT_R1MTH_LCY
       , sum(AST_BSC_FTP_AMT_R3MTH_FCY) AST_BSC_FTP_AMT_R3MTH_FCY
       , sum(AST_BSC_FTP_AMT_R3MTH_LCY) AST_BSC_FTP_AMT_R3MTH_LCY
       , sum(AST_BSC_FTP_AMT_R6MTH_FCY) AST_BSC_FTP_AMT_R6MTH_FCY
       , sum(AST_BSC_FTP_AMT_R6MTH_LCY) AST_BSC_FTP_AMT_R6MTH_LCY
  FROM AST_AR_ANL_FCT_FULL t
  		left join CST_HIER_DIM cst_hier on t.CST_DIM_ID = cst_hier.CST_HIER_DIM_ID
		left join CST_FI_HIER_DIM cst_fi on t.CST_DIM_ID = cst_fi.CST_FI_HIER_DIM_ID
where t.TM_PRD_DIM_ID in (select distinct TM_PRD_DIM_ID from TMP_AR_ANL_FCT_MNUL_DAILY)
  group by 
  	   ACG_STC_GRP_DIM_ID
       , ACT_TM_TO_MAT_SEG_DIM_ID
       , AR_BAL_SEG_DIM_ID
       , AR_CRT_DEPT_DIM_ID
       , AR_FNC_ST_DIM_ID
       , AR_LCS_DIM_ID
       , AR_MGT_DEPT_DIM_ID
       , AR_OFCR_CREATOR_DIM_ID
       , AR_OFCR_EMPE_DIM_ID
       , AR_PPS_DIM_ID
       , AR_TP_DIM_ID
       , BAL_ACG_STC_ITM_DIM_ID
       , BAL_SHET_TP_DIM_ID
       , CCY_DIM_ID
       , CR_LMT_SEG_DIM_ID
       , CR_RSK_RTG_DIM_ID
       , CST_AST_BAL_SEG_DIM_ID
       , CST_CRT_DEPT_DIM_ID
       , CST_LBY_BAL_SEG_DIM_ID
       , CST_LIFE_CYC_ST_DIM_ID
       , CST_MGT_DEPT_DIM_ID
       , CST_MKT_SEG_DIM_ID
       , CST_OFCR_CREATOR_DIM_ID
       , CST_OFCR_EMPE_DIM_ID
       , CST_PERF_ST_DIM_ID
       , CST_SEG_DIM_ID
       , CST_SEG_SME_DIM_ID
       , CST_TP_DIM_ID
       , IDY_SML_ID_DIM_ID
       , INT_RATE_SEG_DIM_ID
       , LINE_OF_BSN_DIM_ID
       , MTH_ISSU_TP_DIM_ID
       , ORG_UNIT_DIM_ID
       , ORIG_TM_TO_MAT_SEG_DIM_ID
       , PD_DIM_ID
       , RMAN_TM_TO_MAT_SEG_DIM_ID
       , RTO_DBT_TP_DIM_ID
       , SCR_CVR_DIM_ID
       , SRC_STM_DIM_ID
       , TM_PRD_DIM_ID
	   , CST_BRTH_AGE_SEG_DIM_ID
	   , CST_AGE_SEG_DIM_ID
	   , CST_BRN_AST_BAL_SEG_DIM_ID
	   , CST_BRN_LBY_BAL_SEG_DIM_ID
	   , nvl(cst_hier.CST_HIER_DIM_ID, 0)
	   , nvl(cst_fi.CST_FI_HIER_DIM_ID,0);

