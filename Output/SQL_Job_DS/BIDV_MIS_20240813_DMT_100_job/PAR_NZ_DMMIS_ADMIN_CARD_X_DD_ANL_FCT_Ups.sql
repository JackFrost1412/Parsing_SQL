SELECT 
c.AR_DIM_ID CARD_DIM_ID,
d.AR_DIM_ID DD_DIM_ID,
t.EFF_DT    EFF_DT,
t.END_DT    END_DT
FROM TWT_CARD_X_DD_ANL_FCT t
LEFT JOIN CSTB_SYSTEM SYS ON SYS.PARAM_NAME = 'ETL_DATE'
INNER JOIN AR_DIM c ON t.CARD_DIM_ID = c.AR_ID 
         AND SYS.PARAM_VALUE >= to_char(c.EFF_FM_DT, 'YYYYDDD')
         AND SYS.PARAM_VALUE < to_char(c.EFF_TO_DT, 'YYYYDDD')
INNER JOIN AR_DIM d ON t.DD_DIM_ID = d.AR_ID 
         AND SYS.PARAM_VALUE >= to_char(d.EFF_FM_DT, 'YYYYDDD')
         AND SYS.PARAM_VALUE < to_char(d.EFF_TO_DT, 'YYYYDDD');

