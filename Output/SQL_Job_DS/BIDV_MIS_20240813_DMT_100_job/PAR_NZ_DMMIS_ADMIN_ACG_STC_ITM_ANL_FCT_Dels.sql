SELECT
	     T.AV_BAL_AMT_WTD_FCY AV_BAL_AMT_WTD_FCY
       , T.AV_BAL_AMT_WTD_LCY AV_BAL_AMT_WTD_LCY
       , T.CHG_AMT_CR_WTD_FCY CHG_AMT_CR_WTD_FCY
       , T.CHG_AMT_CR_WTD_LCY CHG_AMT_CR_WTD_LCY
       , T.CHG_AMT_DB_WTD_FCY CHG_AMT_DB_WTD_FCY
       , T.CHG_AMT_DB_WTD_LCY CHG_AMT_DB_WTD_LCY
       , NVL(LOB_DIM.LINE_OF_BSN_DIM_ID,'0') LINE_OF_BSN_DIM_ID
       , T.NBR_OF_CR_MTD NBR_OF_CR_MTD
       , T.NBR_OF_CR_QTD NBR_OF_CR_QTD
       , T.NBR_OF_CR_TDY NBR_OF_CR_TDY
       , T.NBR_OF_CR_WTD NBR_OF_CR_WTD
       , T.NBR_OF_CR_YTD NBR_OF_CR_YTD
       , T.NBR_OF_DB_MTD NBR_OF_DB_MTD
       , T.NBR_OF_DB_QTD NBR_OF_DB_QTD
       , T.NBR_OF_DB_TDY NBR_OF_DB_TDY
       , T.NBR_OF_DB_WTD NBR_OF_DB_WTD
       , T.NBR_OF_DB_YTD NBR_OF_DB_YTD
       , T.AV_BAL_AMT_MTD_LCY AV_BAL_AMT_MTD_LCY
       , NVL(OU_DIM.ORG_UNIT_DIM_ID,0) ORG_UNIT_DIM_ID
       , NVL(CCY_DIM.CCY_DM_ID,'0') CCY_DIM_ID
       , T.TM_PRD_DIM_ID TM_PRD_DIM_ID
       , NVL(ACG_STC_ITM_DIM.ACG_STC_ITM_DIM_ID,0) ACG_STC_ITM_DIM_ID
       , T.AV_BAL_AMT_MTD_FCY AV_BAL_AMT_MTD_FCY
       , T.AV_BAL_AMT_QTD_FCY AV_BAL_AMT_QTD_FCY
       , T.AV_BAL_AMT_QTD_LCY AV_BAL_AMT_QTD_LCY
       , T.AV_BAL_AMT_YTD_FCY AV_BAL_AMT_YTD_FCY
       , T.AV_BAL_AMT_YTD_LCY AV_BAL_AMT_YTD_LCY
       , T.CHG_AMT_CR_MTD_FCY CHG_AMT_CR_MTD_FCY
       , T.CHG_AMT_CR_MTD_LCY CHG_AMT_CR_MTD_LCY
       , T.CHG_AMT_CR_QTD_FCY CHG_AMT_CR_QTD_FCY
       , T.CHG_AMT_CR_QTD_LCY CHG_AMT_CR_QTD_LCY
       , T.CHG_AMT_CR_TDY_FCY CHG_AMT_CR_TDY_FCY
       , T.CHG_AMT_CR_TDY_LCY CHG_AMT_CR_TDY_LCY
       , T.CHG_AMT_CR_YTD_FCY CHG_AMT_CR_YTD_FCY
       , T.CHG_AMT_CR_YTD_LCY CHG_AMT_CR_YTD_LCY
       , T.CHG_AMT_DB_MTD_FCY CHG_AMT_DB_MTD_FCY
       , T.CHG_AMT_DB_MTD_LCY CHG_AMT_DB_MTD_LCY
       , T.CHG_AMT_DB_QTD_FCY CHG_AMT_DB_QTD_FCY
       , T.CHG_AMT_DB_QTD_LCY CHG_AMT_DB_QTD_LCY
       , T.CHG_AMT_DB_TDY_FCY CHG_AMT_DB_TDY_FCY
       , T.CHG_AMT_DB_TDY_LCY CHG_AMT_DB_TDY_LCY
       , T.CHG_AMT_DB_YTD_FCY CHG_AMT_DB_YTD_FCY
       , T.CHG_AMT_DB_YTD_LCY CHG_AMT_DB_YTD_LCY
       , T.CLS_BAL_AMT_TDY_FCY CLS_BAL_AMT_TDY_FCY
       , T.CLS_BAL_AMT_TDY_LCY CLS_BAL_AMT_TDY_LCY
	   
	   , T.BSC_FTP_AMT_TDY_FCY BSC_FTP_AMT_TDY_FCY
	   , T.BSC_FTP_AMT_TDY_LCY BSC_FTP_AMT_TDY_LCY
	   , T.BSC_FTP_AMT_MTD_FCY BSC_FTP_AMT_MTD_FCY
	   , T.BSC_FTP_AMT_QTD_FCY BSC_FTP_AMT_QTD_FCY
	   , T.BSC_FTP_AMT_YTD_FCY BSC_FTP_AMT_YTD_FCY
	   , T.BSC_FTP_AMT_MTD_LCY BSC_FTP_AMT_MTD_LCY
	   , T.BSC_FTP_AMT_QTD_LCY BSC_FTP_AMT_QTD_LCY
	   , T.BSC_FTP_AMT_YTD_LCY BSC_FTP_AMT_YTD_LCY

	   , T.ADL_FTP_AMT_TDY_FCY ADL_FTP_AMT_TDY_FCY
	   , T.ADL_FTP_AMT_MTD_FCY ADL_FTP_AMT_MTD_FCY
	   , T.ADL_FTP_AMT_QTD_FCY ADL_FTP_AMT_QTD_FCY
	   , T.ADL_FTP_AMT_YTD_FCY ADL_FTP_AMT_YTD_FCY
	   , T.ADL_FTP_AMT_TDY_LCY ADL_FTP_AMT_TDY_LCY
	   , T.ADL_FTP_AMT_MTD_LCY ADL_FTP_AMT_MTD_LCY
	   , T.ADL_FTP_AMT_QTD_LCY ADL_FTP_AMT_QTD_LCY
	   , T.ADL_FTP_AMT_YTD_LCY ADL_FTP_AMT_YTD_LCY

	   , T.FTP_AMT_TDY_FCY FTP_AMT_TDY_FCY
	   , T.FTP_AMT_MTD_FCY FTP_AMT_MTD_FCY
	   , T.FTP_AMT_QTD_FCY FTP_AMT_QTD_FCY
	   , T.FTP_AMT_YTD_FCY FTP_AMT_YTD_FCY
	   , T.FTP_AMT_TDY_LCY FTP_AMT_TDY_LCY
	   , T.FTP_AMT_MTD_LCY FTP_AMT_MTD_LCY
	   , T.FTP_AMT_QTD_LCY FTP_AMT_QTD_LCY
	   , T.FTP_AMT_YTD_LCY FTP_AMT_YTD_LCY
	   , NVL(ACG_EFF_TP_DIM.ACG_EFF_TP_DIM_ID,0) ACG_EFF_TP_DIM_ID

	   FROM TWT_ACG_STC_ITM_ANL_FCT T
LEFT JOIN CSTB_SYSTEM SYS ON SYS.PARAM_NAME = 'ETL_DATE'
LEFT JOIN ACG_STC_ITM_DIM ACG_STC_ITM_DIM ON ACG_STC_ITM_DIM.LVL_0_ID = T.ACG_STC_ITM_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= ACG_STC_ITM_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < ACG_STC_ITM_DIM.EFF_TO_DT
LEFT JOIN OU_DIM OU_DIM ON OU_DIM.ORG_UNIT_ID = T.ORG_UNIT_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= OU_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < OU_DIM.EFF_TO_DT
LEFT JOIN CCY_DIM CCY_DIM ON CCY_DIM.CCY_ID = T.CCY_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= CCY_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < CCY_DIM.EFF_TO_DT
LEFT JOIN LOB_DIM LOB_DIM ON LOB_DIM.LVL_0_ID = T.LINE_OF_BSN_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= LOB_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < LOB_DIM.EFF_TO_DT
LEFT JOIN ACG_EFF_TP_DIM ACG_EFF_TP_DIM ON ACG_EFF_TP_DIM.LVL_0_ID = T.ACG_EFF_TP_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= ACG_EFF_TP_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < ACG_EFF_TP_DIM.EFF_TO_DT;

