SELECT

        NVL(OU_DIM.ORG_UNIT_DIM_ID,0) ORG_UNIT_DIM_ID
       , NVL(CCY_DIM.CCY_DM_ID,'0') CCY_DIM_ID
       , T.TM_PRD_DIM_ID TM_PRD_DIM_ID
       , NVL(ACG_STC_ITM_DIM.ACG_STC_ITM_DIM_ID,0) ACG_STC_ITM_DIM_ID

	   
	   , T.BSC_FTP_AMT_TDY_FCY BSC_FTP_AMT_TDY_FCY
	   , T.BSC_FTP_AMT_TDY_LCY BSC_FTP_AMT_TDY_LCY
	   , T.BSC_FTP_AMT_MTD_FCY BSC_FTP_AMT_MTD_FCY
	   , T.BSC_FTP_AMT_QTD_FCY BSC_FTP_AMT_QTD_FCY
	   , T.BSC_FTP_AMT_YTD_FCY BSC_FTP_AMT_YTD_FCY
	   , T.BSC_FTP_AMT_MTD_LCY BSC_FTP_AMT_MTD_LCY
	   , T.BSC_FTP_AMT_QTD_LCY BSC_FTP_AMT_QTD_LCY
	   , T.BSC_FTP_AMT_YTD_LCY BSC_FTP_AMT_YTD_LCY

	   , T.ADL_FTP_AMT_TDY_FCY ADL_FTP_AMT_TDY_FCY
	   , T.ADL_FTP_AMT_MTD_FCY ADL_FTP_AMT_MTD_FCY
	   , T.ADL_FTP_AMT_QTD_FCY ADL_FTP_AMT_QTD_FCY
	   , T.ADL_FTP_AMT_YTD_FCY ADL_FTP_AMT_YTD_FCY
	   , T.ADL_FTP_AMT_TDY_LCY ADL_FTP_AMT_TDY_LCY
	   , T.ADL_FTP_AMT_MTD_LCY ADL_FTP_AMT_MTD_LCY
	   , T.ADL_FTP_AMT_QTD_LCY ADL_FTP_AMT_QTD_LCY
	   , T.ADL_FTP_AMT_YTD_LCY ADL_FTP_AMT_YTD_LCY

	   , T.FTP_AMT_TDY_FCY FTP_AMT_TDY_FCY
	   , T.FTP_AMT_MTD_FCY FTP_AMT_MTD_FCY
	   , T.FTP_AMT_QTD_FCY FTP_AMT_QTD_FCY
	   , T.FTP_AMT_YTD_FCY FTP_AMT_YTD_FCY
	   , T.FTP_AMT_TDY_LCY FTP_AMT_TDY_LCY
	   , T.FTP_AMT_MTD_LCY FTP_AMT_MTD_LCY
	   , T.FTP_AMT_QTD_LCY FTP_AMT_QTD_LCY
	   , T.FTP_AMT_YTD_LCY FTP_AMT_YTD_LCY


	   FROM TWT_ACG_STC_ITM_ANL_FTP_FCT T
LEFT JOIN CSTB_SYSTEM SYS ON SYS.PARAM_NAME = 'ETL_DATE'
LEFT JOIN ACG_STC_ITM_DIM ACG_STC_ITM_DIM ON ACG_STC_ITM_DIM.LVL_0_ID = T.ACG_STC_ITM_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= ACG_STC_ITM_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < ACG_STC_ITM_DIM.EFF_TO_DT
LEFT JOIN OU_DIM OU_DIM ON OU_DIM.ORG_UNIT_ID = T.ORG_UNIT_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= OU_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < OU_DIM.EFF_TO_DT
LEFT JOIN CCY_DIM CCY_DIM ON CCY_DIM.CCY_ID = T.CCY_DIM_ID AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') >= CCY_DIM.EFF_FM_DT AND TO_DATE(SYS.PARAM_VALUE,'YYYYDDD') < CCY_DIM.EFF_TO_DT
;

