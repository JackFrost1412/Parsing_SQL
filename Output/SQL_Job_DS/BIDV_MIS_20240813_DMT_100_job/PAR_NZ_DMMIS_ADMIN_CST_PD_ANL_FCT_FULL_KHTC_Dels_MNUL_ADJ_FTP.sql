truncate table CST_PD_ANL_FCT_FULL_KHTC_DAILY_RERUN;

insert into CST_PD_ANL_FCT_FULL_KHTC_DAILY_RERUN
select * from admin.CST_PD_ANL_FCT_FULL_KHTC 
where TM_PRD_DIM_ID in (select distinct TM_PRD_DIM_ID from TMP_CST_PD_ANL_FCT_MNUL_DAILY);

delete from admin.CST_PD_ANL_FCT_FULL_KHTC where TM_PRD_DIM_ID in (select distinct TM_PRD_DIM_ID from TMP_CST_PD_ANL_FCT_MNUL_DAILY);

insert into CST_PD_ANL_FCT_FULL_KHTC
SELECT t.CST_ID
       , t.PD_ID
       , t.ORG_UNIT_ID
       , t.PD_TP
       , t.CST_DIM_ID
       , t.PD_DIM_ID
       , t.SLRY_TVR_DIM_ID
       , t.GND_DIM_ID
       , t.CST_BRTH_AGE_SEG_DIM_ID
       , t.ADDR
       , t.OCP_DIM_ID
       , t.MAR_ST_DIM_ID
       , t.CST_HIER_DIM_ID
       , t.CST_LCS_TP_DIM_ID
       , t.CST_TP_DIM_ID
       , t.CST_MKT_SEG_DIM_ID
       , t.CST_AGE_SEG_DIM_ID
       , t.TM_PRD_DIM_ID
       , t.CST_ORG_UNIT_DIM_ID
       , t.ORG_UNIT_DIM_ID
       , t.CR_RSK_RTG_DIM_ID
       , t.CR_LMT_SEG_DIM_ID
       , t.IDY_SML_ID_DIM_ID
       , t.CST_AST_BAL_SEG_DIM_ID
       , t.CST_LBY_BAL_SEG_DIM_ID
       , t.CST_PERF_ST_DIM_ID
       , t.CST_RLTNP_OFCR_DIM_ID
       , t.CST_CRT_DEPT_DIM_ID
       , t.CST_MGT_DEPT_DIM_ID
       , t.CST_SEG_DIM_ID
       , t.NBR_OF_AR_TDY
       , t.NBR_OF_ACTIVE_AR_TDY
       , t.NBR_NEW_AR_TDY
       , t.NBR_CLS_AR_TDY
       , t.TOT_AST_CLS_BAL_AMT_TDY_LCY
       , t.TOT_LBY_CLS_BAL_AMT_TDY_LCY
       , t.TOT_AST_CLS_BAL_AMT_TDY_FCY
       , t.TOT_LBY_CLS_BAL_AMT_TDY_FCY
       , t.TOT_CST_CR_AMT_MTD_LCY
       , t.TOT_CST_CR_AMT_QTD_LCY
       , t.TOT_CST_CR_AMT_YTD_LCY
       , t.TOT_CST_CR_AMT_TDY_LCY
       , t.TOT_CST_DB_AMT_MTD_LCY
       , t.TOT_CST_DB_AMT_QTD_LCY
       , t.TOT_CST_DB_AMT_YTD_LCY
       , t.TOT_CST_DB_AMT_TDY_LCY
       , t.TOT_OTHR_CR_AMT_MTD
       , t.TOT_OTHR_CR_AMT_QTD
       , t.TOT_OTHR_CR_AMT_YTD
       , t.TOT_OTHR_CR_AMT_TDY
       , t.TOT_OTHR_DB_AMT_MTD
       , t.TOT_OTHR_DB_AMT_QTD
       , t.TOT_OTHR_DB_AMT_YTD
       , t.TOT_OTHR_DB_AMT_TDY
       , t.TOT_NBR_OF_CST_CR_MTD
       , t.TOT_NBR_OF_CST_CR_QTD
       , t.TOT_NBR_OF_CST_CR_TDY
       , t.TOT_NBR_OF_CST_CR_YTD
       , t.TOT_NBR_OF_CST_DB_MTD
       , t.TOT_NBR_OF_CST_DB_QTD
       , t.TOT_NBR_OF_CST_DB_TDY
       , t.TOT_NBR_OF_CST_DB_YTD
       , t.TOT_NBR_OF_OTHR_CR_MTD
       , t.TOT_NBR_OF_OTHR_CR_QTD
       , t.TOT_NBR_OF_OTHR_CR_TDY
       , t.TOT_NBR_OF_OTHR_CR_YTD
       , t.TOT_NBR_OF_OTHR_DB_MTD
       , t.TOT_NBR_OF_OTHR_DB_QTD
       , t.TOT_NBR_OF_OTHR_DB_TDY
       , t.TOT_NBR_OF_OTHR_DB_YTD
       , t.CST_PD_ST_CODE
       , t.CST_PD_ST_DIM_ID
       , t.PD_USG_ST_DIM_ID
       , t.TOT_AST_CLS_BAL_AMT_LMTH_LCY
       , t.TOT_LBY_CLS_BAL_AMT_LMTH_LCY
       , t.TOT_AST_CLS_BAL_AMT_LQTR_LCY
       , t.TOT_LBY_CLS_BAL_AMT_LQTR_LCY
       , t.TOT_AST_CLS_BAL_AMT_LYR_LCY
       , t.TOT_LBY_CLS_BAL_AMT_LYR_LCY
       , t.NBR_NEW_AR_MTD
       , t.NBR_CLS_AR_MTD
       , t.NBR_NEW_AR_QTD
       , t.NBR_CLS_AR_QTD
       , t.NBR_NEW_AR_YTD
       , t.NBR_CLS_AR_YTD
       , t.TOT_FEE_INCM_AMT_TDY_LCY
       , t.TOT_FEE_INCM_AMT_MTD_LCY
       , t.TOT_FEE_INCM_AMT_QTD_LCY
       , t.TOT_FEE_INCM_AMT_YTD_LCY
       , t.NBR_OF_FNC_TXN_MTD
       , t.NBR_OF_FNC_TXN_QTD
       , t.NBR_OF_FNC_TXN_YTD
       , t.NBR_OF_FNC_TXN_TDY
       , t.NBR_OF_NFNC_TXN_MTD
       , t.NBR_OF_NFNC_TXN_QTD
       , t.NBR_OF_NFNC_TXN_YTD
       , t.NBR_OF_NFNC_TXN_TDY
       , t.SRC_STM_DIM_ID
       , t.TOT_NBR_OF_CST_TXN_MTD
       , t.TOT_NBR_OF_CST_TXN_QTD
       , t.TOT_NBR_OF_CST_TXN_TDY
       , t.TOT_NBR_OF_CST_TXN_YTD
       , t.TOT_ACTV_TXN_CR_AMT_MTD_LCY
       , t.TOT_ACTV_TXN_CR_AMT_QTD_LCY
       , t.TOT_ACTV_TXN_CR_AMT_YTD_LCY
       , t.TOT_ACTV_TXN_CR_AMT_TDY_LCY
       , t.TOT_ACTV_TXN_DB_AMT_MTD_LCY
       , t.TOT_ACTV_TXN_DB_AMT_QTD_LCY
       , t.TOT_ACTV_TXN_DB_AMT_YTD_LCY
       , t.TOT_ACTV_TXN_DB_AMT_TDY_LCY
       , t.TOT_PASSIVE_TXN_CR_AMT_MTD_LCY
       , t.TOT_PASSIVE_TXN_CR_AMT_QTD_LCY
       , t.TOT_PASSIVE_TXN_CR_AMT_YTD_LCY
       , t.TOT_PASSIVE_TXN_CR_AMT_TDY_LCY
       , t.TOT_PASSIVE_TXN_DB_AMT_MTD_LCY
       , t.TOT_PASSIVE_TXN_DB_AMT_QTD_LCY
       , t.TOT_PASSIVE_TXN_DB_AMT_YTD_LCY
       , t.TOT_PASSIVE_TXN_DB_AMT_TDY_LCY
       , t.TOT_NBR_OF_ACTV_TXN_CR_MTD
       , t.TOT_NBR_OF_ACTV_TXN_CR_QTD
       , t.TOT_NBR_OF_ACTV_TXN_CR_YTD
       , t.TOT_NBR_OF_ACTV_TXN_CR_TDY
       , t.TOT_NBR_OF_ACTV_TXN_DB_MTD
       , t.TOT_NBR_OF_ACTV_TXN_DB_QTD
       , t.TOT_NBR_OF_ACTV_TXN_DB_TDY
       , t.TOT_NBR_OF_ACTV_TXN_DB_YTD
       , t.TOT_NBR_OF_PASSIVE_TXN_CR_MTD
       , t.TOT_NBR_OF_PASSIVE_TXN_CR_QTD
       , t.TOT_NBR_OF_PASSIVE_TXN_CR_YTD
       , t.TOT_NBR_OF_PASSIVE_TXN_CR_TDY
       , t.TOT_NBR_OF_PASSIVE_TXN_DB_MTD
       , t.TOT_NBR_OF_PASSIVE_TXN_DB_QTD
       , t.TOT_NBR_OF_PASSIVE_TXN_DB_YTD
       , t.TOT_NBR_OF_PASSIVE_TXN_DB_TDY
       , t.CLS_PD_IND
       , t.CTY_OF_RSDNC_DIM_ID
       , t.EMPE_DIM_ID
       , t.NBR_OF_DYS_HTD
       , t.NBR_OF_DYS_MTD
       , t.NBR_OF_DYS_QTD
       , t.NBR_OF_DYS_YTD
       , t.LAST_CST_TXN_DT_DIM_ID
       , t.NBR_OF_OD_AC
       , t.SLRY_CR_TXN_IND
       , t.CST_PD_ST_BRN_CODE
       , t.CST_PD_ST_BRN_DIM_ID
       , t.TOT_AST_ACR_INT_AMT_MTD_LCY
       , t.TOT_AST_ACR_INT_AMT_QTD_LCY
       , t.TOT_AST_ACR_INT_AMT_YTD_LCY
       , t.TOT_AST_ACR_INT_AMT_TDY_LCY
       , t.TOT_LBY_ACR_INT_AMT_MTD_LCY
       , t.TOT_LBY_ACR_INT_AMT_QTD_LCY
       , t.TOT_LBY_ACR_INT_AMT_YTD_LCY
       , t.TOT_LBY_ACR_INT_AMT_TDY_LCY
       , t.TOT_AST_INT_PYMT_AMT_MTD_LCY
       , t.TOT_AST_INT_PYMT_AMT_QTD_LCY
       , t.TOT_AST_INT_PYMT_AMT_TDY_LCY
       , t.TOT_AST_INT_PYMT_AMT_YTD_LCY
       , t.TOT_LBY_INT_PYMT_AMT_MTD_LCY
       , t.TOT_LBY_INT_PYMT_AMT_QTD_LCY
       , t.TOT_LBY_INT_PYMT_AMT_TDY_LCY
       , t.TOT_LBY_INT_PYMT_AMT_YTD_LCY
       , t.TOT_LBY_ACR_PNY_INT_MTD_LCY
       , t.TOT_LBY_ACR_PNY_INT_QTD_LCY
       , t.TOT_LBY_ACR_PNY_INT_TDY_LCY
       , t.TOT_LBY_ACR_PNY_INT_YTD_LCY
       , t.TOT_AST_ADJ_FTP_AMT_LTD_LCY
       , t.TOT_AST_ADJ_FTP_AMT_MTD_LCY
       , t.TOT_AST_ADJ_FTP_AMT_QTD_LCY
       , t.TOT_AST_ADJ_FTP_AMT_TDY_LCY
       , t.TOT_AST_ADJ_FTP_AMT_YTD_LCY
       , t.TOT_AST_BSC_FTP_AMT_LTD_LCY
       , t.TOT_AST_BSC_FTP_AMT_MTD_LCY
       , t.TOT_AST_BSC_FTP_AMT_QTD_LCY
       , t.TOT_AST_BSC_FTP_AMT_TDY_LCY
       , t.TOT_AST_BSC_FTP_AMT_YTD_LCY
       , t.TOT_AST_MNUL_ADJ_FTP_AMT_LTD_LCY
       , nvl(tmp.TOT_AST_MNUL_ADJ_FTP_AMT_MTD_LCY, 0)	TOT_AST_MNUL_ADJ_FTP_AMT_MTD_LCY
       , nvl(tmp.TOT_AST_MNUL_ADJ_FTP_AMT_QTD_LCY, 0)	TOT_AST_MNUL_ADJ_FTP_AMT_QTD_LCY
       , nvl(tmp.TOT_AST_MNUL_ADJ_FTP_AMT_TDY_LCY, 0)	TOT_AST_MNUL_ADJ_FTP_AMT_TDY_LCY
       , nvl(tmp.TOT_AST_MNUL_ADJ_FTP_AMT_YTD_LCY, 0)	TOT_AST_MNUL_ADJ_FTP_AMT_YTD_LCY
       , t.TOT_LBY_ADJ_FTP_AMT_LTD_LCY
       , t.TOT_LBY_ADJ_FTP_AMT_MTD_LCY
       , t.TOT_LBY_ADJ_FTP_AMT_QTD_LCY
       , t.TOT_LBY_ADJ_FTP_AMT_TDY_LCY
       , t.TOT_LBY_ADJ_FTP_AMT_YTD_LCY
       , t.TOT_LBY_BSC_FTP_AMT_LTD_LCY
       , t.TOT_LBY_BSC_FTP_AMT_MTD_LCY
       , t.TOT_LBY_BSC_FTP_AMT_QTD_LCY
       , t.TOT_LBY_BSC_FTP_AMT_TDY_LCY
       , t.TOT_LBY_BSC_FTP_AMT_YTD_LCY
       , t.TOT_LBY_MNUL_FTP_AMT_LTD_LCY
       , nvl(tmp.TOT_LBY_MNUL_FTP_AMT_MTD_LCY, 0)	TOT_LBY_MNUL_FTP_AMT_MTD_LCY
       , nvl(tmp.TOT_LBY_MNUL_FTP_AMT_QTD_LCY, 0)	TOT_LBY_MNUL_FTP_AMT_QTD_LCY
       , nvl(tmp.TOT_LBY_MNUL_FTP_AMT_TDY_LCY, 0)	TOT_LBY_MNUL_FTP_AMT_TDY_LCY
       , nvl(tmp.TOT_LBY_MNUL_FTP_AMT_YTD_LCY, 0)	TOT_LBY_MNUL_FTP_AMT_YTD_LCY
       , t.LBY_PNY_FTP_AMT_MTD_LCY
       , t.LBY_PNY_FTP_AMT_QTD_LCY
       , t.LBY_PNY_FTP_AMT_TDY_LCY
       , t.LBY_PNY_FTP_AMT_YTD_LCY
       , t.LBY_PNY_FTP_AMT_LTD_LCY
       , t.TOT_AST_INT_INCM_AMT_MTD_LCY
       , t.TOT_AST_INT_INCM_AMT_QTD_LCY
       , t.TOT_AST_INT_INCM_AMT_YTD_LCY
       , t.TOT_AST_INT_INCM_AMT_TDY_LCY
       , t.TOT_LBY_INT_EXPN_AMT_MTD_LCY
       , t.TOT_LBY_INT_EXPN_AMT_QTD_LCY
       , t.TOT_LBY_INT_EXPN_AMT_YTD_LCY
       , t.TOT_LBY_INT_EXPN_AMT_TDY_LCY

  FROM DMMIS.ADMIN.CST_PD_ANL_FCT_FULL_KHTC_DAILY_RERUN t
  LEFT JOIN TMP_CST_PD_ANL_FCT_MNUL_DAILY tmp on t.TM_PRD_DIM_ID = tmp.TM_PRD_DIM_ID and t.CST_DIM_ID = tmp.CST_DIM_ID
  and t.PD_DIM_ID = tmp.PD_DIM_ID and t.SRC_STM_DIM_ID = tmp.SRC_STM_DIM_ID;

