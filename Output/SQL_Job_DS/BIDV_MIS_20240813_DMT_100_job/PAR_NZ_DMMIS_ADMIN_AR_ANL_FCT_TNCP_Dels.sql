SELECT 	AST.AR_ID
       , MSR_PRD_ID  	TM_PRD_DIM_ID
       ,    AST_INT_INCM_MTD_FCY
       ,    AST_INT_INCM_MTD_LCY
       ,    AST_INT_INCM_QTD_FCY
       ,    AST_INT_INCM_QTD_LCY
       ,    AST_INT_INCM_TDY_FCY
       ,    AST_INT_INCM_TDY_LCY
       ,    AST_INT_INCM_YTD_FCY
       ,    AST_INT_INCM_YTD_LCY
       ,    AST_INT_INCM_HTD_FCY
       ,    AST_INT_INCM_HTD_LCY
       ,    AST_INT_INCM_R1MTH_FCY
       ,    AST_INT_INCM_R1MTH_LCY
       ,    AST_INT_INCM_R3MTH_FCY
       ,    AST_INT_INCM_R3MTH_LCY
       ,    AST_INT_INCM_R6MTH_FCY
       ,    AST_INT_INCM_R6MTH_LCY
       ,    AST_INT_INCM_R12MTH_FCY
       ,    AST_INT_INCM_R12MTH_LCY
       , 0    LBY_INT_INCM_ROLLING_12MTH_FCY
       , 0    LBY_INT_INCM_ROLLING_12MTH_LCY
       , 0    LBY_INT_INCM_ROLLING_6MTH_FCY
       , 0    LBY_INT_INCM_ROLLING_6MTH_LCY
       , 0    LBY_INT_INCM_ROLLING_3MTH_FCY
       , 0    LBY_INT_INCM_ROLLING_3MTH_LCY
       , 0    LBY_INT_INCM_ROLLING_1MTH_FCY
       , 0    LBY_INT_INCM_ROLLING_1MTH_LCY
       , 0    LBY_INT_INCM_MTD_FCY
       , 0    LBY_INT_INCM_MTD_LCY
       , 0    LBY_INT_INCM_QTD_FCY
       , 0    LBY_INT_INCM_QTD_LCY
       , 0    LBY_INT_INCM_TDY_FCY
       , 0    LBY_INT_INCM_TDY_LCY
       , 0    LBY_INT_INCM_YTD_FCY
       , 0    LBY_INT_INCM_YTD_LCY

  FROM AS_AR_INT_CLC_SMY_TNCP_DAILY AST;

delete from AR_ANL_FCT_TNCP where tm_prd_dim_id = :pDate:;

insert into AR_ANL_FCT_TNCP
select * from AR_ANL_FCT_TNCP_DAILY;

SELECT 	LBY.AR_ID
       , MSR_PRD_ID  	TM_PRD_DIM_ID
	       , 0   AST_INT_INCM_MTD_FCY
       , 0   AST_INT_INCM_MTD_LCY
       , 0   AST_INT_INCM_QTD_FCY
       , 0   AST_INT_INCM_QTD_LCY
       , 0   AST_INT_INCM_TDY_FCY
       , 0   AST_INT_INCM_TDY_LCY
       , 0   AST_INT_INCM_YTD_FCY
       , 0   AST_INT_INCM_YTD_LCY
       , 0   AST_INT_INCM_HTD_FCY
       , 0   AST_INT_INCM_HTD_LCY
       , 0   AST_INT_INCM_R1MTH_FCY
       , 0   AST_INT_INCM_R1MTH_LCY
       , 0   AST_INT_INCM_R3MTH_FCY
       , 0   AST_INT_INCM_R3MTH_LCY
       , 0   AST_INT_INCM_R6MTH_FCY
       , 0   AST_INT_INCM_R6MTH_LCY
       , 0   AST_INT_INCM_R12MTH_FCY
       , 0   AST_INT_INCM_R12MTH_LCY
       , LBY_INT_INCM_ROLLING_12MTH_FCY
       , LBY_INT_INCM_ROLLING_12MTH_LCY
       , LBY_INT_INCM_ROLLING_6MTH_FCY
       , LBY_INT_INCM_ROLLING_6MTH_LCY
       , LBY_INT_INCM_ROLLING_3MTH_FCY
       , LBY_INT_INCM_ROLLING_3MTH_LCY
       , LBY_INT_INCM_ROLLING_1MTH_FCY
       , LBY_INT_INCM_ROLLING_1MTH_LCY
       , LBY_INT_INCM_MTD_FCY
       , LBY_INT_INCM_MTD_LCY
       , LBY_INT_INCM_QTD_FCY
       , LBY_INT_INCM_QTD_LCY
       , LBY_INT_INCM_TDY_FCY
       , LBY_INT_INCM_TDY_LCY
       , LBY_INT_INCM_YTD_FCY
       , LBY_INT_INCM_YTD_LCY

  FROM LBY_AR_INT_CLC_SMY_TNCP_DAILY LBY;

SELECT 	AR_DIM.AR_ID    		AR_ID, 
		AR_DIM.AR_DIM_ID		AR_DIM_ID,
		TP.AR_TP_DIM_ID         AR_TP_DIM_ID
FROM AR_DIM
INNER JOIN AR_TP_DIM TP ON TP.LVL_0_NM_ENG = AR_DIM.AR_TP
WHERE SRC_STM IN ('SIBS_CDMAST', 'SIBS_DDMAST','SIBS_LNMAST', 'SIBS_ODTIER','CADENCIE_ACCT','SIBS_TFMAST','TTSPKB')
AND AR_DIM.EFF_FM_DT <= TO_DATE(:pDate:, 'YYYYDDD')  AND AR_DIM.EFF_TO_DT > TO_DATE(:pDate:, 'YYYYDDD');

